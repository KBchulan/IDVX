重写了一些管理器，方便后续扩展
